
\chapter{FDM}

\section{有限差分格式}

通常 FDM 有离散记号:


时域: 
\begin{equation}
    \begin{aligned}
        n&=0,1,...,N_t \\
        t&=n\Delta t \\
        t_{max} &= T = N_t \Delta t
    \end{aligned}
\end{equation}
总之, 有$N_t$ 个 space, $N_t + 1$ 个 node. 

空间:
\begin{equation}
    \begin{aligned}
        i = 0, 1, ..., N_x \\
        x_i = i \Delta x
    \end{aligned}
\end{equation}
总之, 有 $N_x$ 个 space, $N_x + 1$ 个 node. 

最后, 有通用的FDM格式记号:
\begin{equation}
    \begin{aligned}
        &u^{\prime}\left(t_{n}\right) \approx\left[D_{t} u\right]^{n}=\frac{u^{n+\frac{1}{2}}-u^{n-\frac{1}{2}}}{\Delta t}\\
        &u^{\prime}\left(t_{n}\right) \approx\left[D_{2 t} u\right]^{n}=\frac{u^{n+1}-u^{n-1}}{2 \Delta t}\\
        &u^{\prime}\left(t_{n}\right)=\left[D_{t}^{-} u\right]^{n}=\frac{u^{n}-u^{n-1}}{\Delta t}\\
        &u^{\prime}\left(t_{n}\right) \approx\left[D_{t}^{+} u\right]^{n}=\frac{u^{n+1}-u^{n}}{\Delta t}\\
        &u^{\prime}\left(t_{n+\theta}\right)=\left[\bar{D}_{t} u\right]^{n+\theta}=\frac{u^{n+1}-u^{n}}{\Delta t}\\
        &u^{\prime}\left(t_{n}\right) \approx\left[D_{t}^{2-} u\right]^{n}=\frac{3 u^{n}-4 u^{n-1}+u^{n-2}}{2 \Delta t}\\
        &u^{\prime \prime}\left(t_{n}\right) \approx\left[D_{t} D_{t} u\right]^{n}=\frac{u^{n+1}-2 u^{n}+u^{n-1}}{\Delta t^{2}}\\
        &u\left(t_{n+\frac{1}{2}}\right) \approx\left[\bar{u}^{t}\right]^{n+\frac{1}{2}}=\frac{1}{2}\left(u^{n+1}+u^{n}\right)\\
        &u\left(t_{n+\frac{1}{2}}\right)^{2} \approx\left[{\overline{u^{2}}}^{t, g}\right]^{n+\frac{1}{2}}=u^{n+1} u^{n}\\
        &u\left(t_{n+\frac{1}{2}}\right) \approx\left[\bar{u}^{t, h}\right]^{n+\frac{1}{2}}=\frac{2}{\frac{1}{u^{n+1}}+\frac{1}{u^{n}}}\\
        &u\left(t_{n+\theta}\right) \approx\left[\bar{u}^{t, \theta}\right]^{n+\theta}=\theta u^{n+1}+(1-\theta) u^{n}\\
        &t_{n+\theta}=\theta t_{n+1}+(1-\theta) t_{n-1}
        \end{aligned}
\end{equation}
